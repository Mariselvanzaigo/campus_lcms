<div class="container-fluid">

    <div class="row">
      <div class="col-12 title-head mb-3">
        <h2 id="header_breadcrumbs">Organization / Institute / Add College</h2>                
        <span class="orange-btn nbtn">
            <button type="button" class="btn btn-primary d-none" id="preview_institute" data-bs-toggle="modal" data-bs-target="#previewmodal">
              Preview
            </button>
          </span>
    </div>      
    </div>

    <div class="row">
      
        <div class="col-md-12">
          <div class="white-bg p-3 relative"> 
            <div class="searchbar mt-3">
              <h4 id="stage_head_1" class="stage_head">Create College</h4>
              <h4 id="stage_head_2" class="stage_head d-none">Create Admin</h4>
              <h4 id="stage_head_3" class="stage_head d-none">Manage Academics</h4>
            </div>
            <div class="s-stepper">
                <div data-target="#stage1" id="stage-1-step" class="s-step active">
                    <span class="s-step-counter"></span>
                    <small>Create College</small>
                    <span><i class="fas fa-angle-double-right"></i></span>
                </div>
                <div data-target="#stage2" id="stage-2-step" class="s-step">
                    <span class="s-step-counter"></span>
                    <small>Create Admin</small>
                    <span><i class="fas fa-angle-double-right"></i></span>
                </div>
                <div data-target="#stage3" id="stage-3-step" class="s-step">
                    <span class="s-step-counter"></span>
                    <small>Manage Academics</small>
                </div>
            </div>
            <div class="s-stepper-content mt-3 p-2">
                <!--stage one start-->
                <div id="stage1" class="s-stepper-stage active">
                    <div class="steper-details">
                           <div class="row">
                            <div class="col-md-4">
                                
                              <div class="container p-0">
                                <div class="row">
                                  <div class="col-md-12">
                                    <div class="setting-card outer-wrapper" id="logo_image">
                                      <div class="item">
                                        <!-- Dropzone start --> 
                                        <div id="dropzone" class="dropzone_4" >
                                          <form id="demo-upload_4" class="dropzone needsclick" enctype="multipart/form-data" action="/ajax_file_upload_handler/">
                                            <div id="upload-2-queue" class="queue pt-0 uploaded_display"></div>
                                            <div id="upload-2-dropzone"></div>                              
                                            <div id="preview-template_4" style="display: none;">
                                              <div class="dz-preview dz-file-preview" style="display:none;">
                                                <div class="dz-image"><img data-dz-thumbnail=""></div>
                                                <div class="dz-details">
                                                  <div class="dz-size">
                                                    <span data-dz-size=""></span>
                                                  </div>
                                                  <div class="dz-filename">
                                                    <span data-dz-name=""></span>
                                                  </div>
                                                </div>
                                                <div class="dz-progress">
                                                  <span class="dz-upload" data-dz-uploadprogress=""></span>
                                                </div>
                                                <div class="dz-error-message">
                                                  <span data-dz-errormessage=""></span>
                                                </div>
                                              </div>
                                            </div>
                                          </form>
                                          <div class="dropzone_4_prev" style="display: none;"><img class="dropzone_4_image_preview" src="" /></div>
                                      </div>
                                        
                                      <!-- Dropzone End -->
                                      
                                    </div>
                                  </div>
                                  <!-- <p class="vinfo"><small>Accepts Maximum size of 4 MB Images</small></p> -->
                                  </div>                                   
                                </div>
                              </div>

                            </div>
                            <div class="col-md-8">
                                
                              <div class="container p-0">
                                <div class="row">
                                  <div class="col-md-12">
                                    <div class="setting-card outer-wrapper" id="cover_image">
                                      <div class="item">
                                        <!-- Dropzone start --> 
                                        <div id="dropzone" class="dropzone_1" >
                                          <form id="demo-upload_1" class="dropzone needsclick" enctype="multipart/form-data" action="/ajax_file_upload_handler/">
                                            <div id="upload-2-queue" class="queue pt-0 uploaded_display"></div>
                                            <div id="upload-2-dropzone"></div>                              
                                            <div id="preview-template_1" style="display: none;">
                                              <div class="dz-preview dz-file-preview" style="display:none;">
                                                <div class="dz-image"><img data-dz-thumbnail=""></div>
                                                <div class="dz-details">
                                                  <div class="dz-size">
                                                    <span data-dz-size=""></span>
                                                  </div>
                                                  <div class="dz-filename">
                                                    <span data-dz-name=""></span>
                                                  </div>
                                                </div>
                                                <div class="dz-progress">
                                                  <span class="dz-upload" data-dz-uploadprogress=""></span>
                                                </div>
                                                <div class="dz-error-message">
                                                  <span data-dz-errormessage=""></span>
                                                </div>
                                              </div>
                                            </div>
                                          </form>
                                          <div class="dropzone_1_prev" style="display: none;"><img class="dropzone_1_image_preview" src="" /></div>
                                      </div>
                                        
                                      <!-- Dropzone End -->
                                      
                                    </div>
                                  </div>
                                  <!-- <p class="vinfo"><small>Accepts Maximum size of 4 MB Images</small></p> -->
                                  </div>                                   
                                </div>
                              </div>

                            </div>
                           </div>

                          <form method="post" id="frmNewCmsIns" name="frmNewCmsIns" class="pop-form">
                            <div class="row">
                              <div class="col-md-12">
                                  <div class="mt-3 mb-3">
                                      <label>College name</label>
                                      <input type="text" class="form-control" id="ins_name" name="ins_name" placeholder="Enter College Name">
                                  </div>
                              </div>
                              <div class="col-md-12">
                                  <div class="mb-3">
                                      <label>Website</label>
                                      <input type="text" class="form-control" id="ins_website" name="ins_website" placeholder="Enter Website">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Phone Number</label>
                                    <input type="tel" class="form-control" name="ins_phone_no" id="ins_phone_no" data-fieldName="ins_phone_no" placeholder="Enter Phone Number" value="" onkeypress="return /[0-9 +]/i.test(event.key);" onpaste="return /[0-9 +]/i.test(event.key);">
                                    <!-- <input type="text" class="form-control" id="ins_phone_no" name="ins_phone_no" placeholder="Enter Your Phone Number"> -->
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Email</label>
                                    <input type="text" class="form-control" id="ins_email_id" name="ins_email_id" placeholder="Enter Email">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Address Line 1</label>
                                    <input type="text" class="form-control" id="ins_address_line_1" name="ins_address_line_1" placeholder="Enter Address Line 1">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Address Line 2</label>
                                    <input type="text" class="form-control" id="ins_address_line_2" name="ins_address_line_2" placeholder="Enter Address Line 2">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>City</label>
                                    <input type="text" class="form-control" id="ins_city" name="ins_city" placeholder="Enter City">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>State</label>
                                    <input type="text" class="form-control" id="ins_state" name="ins_state" placeholder="Enter State">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Country</label>
                                    <input type="text" class="form-control" id="ins_country" name="ins_country" placeholder="Enter Country">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Zip Code</label>
                                    <input type="number" class="form-control" id="ins_zip_code" name="ins_zip_code" placeholder="Enter Zip Code">
                                  </div>
                              </div>
                              <!-- <div class="col-md-6">
                                  <div class="mb-3">
                                      <label>Organization</label>
                                      <div class="dropdown-select org_list_container">
                                        <select class="sort-select form-control" id="ins_organization" name="ins_organization" onchange="getSetOrgCode(event);">
                                        </select>
                                      </div>
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                      <label>Organization Code</label>
                                      <input type="text" class="form-control" id="ins_organization_code" name="ins_organization_code" placeholder="Enter Organization Code" disabled="true">
                                  </div>
                              </div> -->
                              <div class="col-md-6">
                                  <div class="mb-3">
                                      <label>Registration Details</label>
                                      <input type="text" class="form-control" id="ins_registration_details" name="ins_registration_details" placeholder="Enter Registration Details">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                      <label>Regoconition Details</label>
                                      <textarea id="ins_recogonition_details" name="ins_recogonition_details" class="form-control" maxlength="256" placeholder="Enter Regoconition Details"></textarea>
                                  </div>
                              </div>
                            </div>  
                          </form>
                         
                          
                    </div>
                    
                    <div class="d-flex justify-content-between mt-3">
                        <div>
                            <span class="blue-border-btn">
                                <button type="button" class="btn btn-primary">
                                  Cancel
                                </button>
                            </span>
                        </div>
                        <div class="d-flex justify-content-end">
                            <!-- <span class="orange-btn me-3">
                                <button>Save <i class="fa fa-right"></i></button>
                            </span> -->
                            <span class="orange-btn">
                            <button id="save_institute">Save & Next <i class="fa fa-right"></i></button>
                            </span>
                        </div>
                    </div>
                </div>
                <!--stage one end-->

                <!--stage two start-->
                <div id="stage2" class="s-stepper-stage">
                    <div class="steper-details">
                        <div class="row">
                          <div class="col-md-3">
                             


                            <div class="container p-0">
                              <div class="row">
                                <div class="col-md-12">
                                  <div class="setting-card outer-wrapper" id="logo_image">
                                    <div class="item">
                                      <!-- Dropzone start --> 
                                      <div id="dropzone" class="dropzone_2" >
                                        <form id="demo-upload_2" class="dropzone needsclick" enctype="multipart/form-data" action="/ajax_file_upload_handler/">
                                          <div id="upload-2-queue" class="queue pt-0 uploaded_display"></div>
                                          <div id="upload-2-dropzone"></div>                              
                                          <div id="preview-template_2" style="display: none;">
                                            <div class="dz-preview dz-file-preview" style="display:none;">
                                              <div class="dz-image"><img data-dz-thumbnail=""></div>
                                              <div class="dz-details">
                                                <div class="dz-size">
                                                  <span data-dz-size=""></span>
                                                </div>
                                                <div class="dz-filename">
                                                  <span data-dz-name=""></span>
                                                </div>
                                              </div>
                                              <div class="dz-progress">
                                                <span class="dz-upload" data-dz-uploadprogress=""></span>
                                              </div>
                                              <div class="dz-error-message">
                                                <span data-dz-errormessage=""></span>
                                              </div>
                                            </div>
                                          </div>
                                        </form>
                                        <div class="dropzone_2_prev" style="display: none;"><img class="dropzone_2_image_preview" src="" /></div>
                                    </div>
                                      
                                    <!-- Dropzone End -->
                                    
                                  </div>
                                </div>
                                <!-- <p class="vinfo"><small>Accepts Maximum size of 4 MB Images</small></p> -->
                                </div>                                   
                              </div>
                            </div>


                          </div>
                        </div>

                        <form method="post" id="frmNewCmsUser" name="frmNewCmsUser" class="pop-form">
                          <div class="row">                            
                              <div class="col-md-6">
                                  <div class="mb-3">
                                  <label>First name (principal)</label>
                                  <input type="text" class="form-control" id="user_first_name" name="user_first_name" placeholder="Enter First Name">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                  <label>Last Name</label>
                                  <input type="text" class="form-control" id="user_last_name" name="user_last_name" placeholder="Enter Last Name">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                  <label>Phone Number</label>
                                  <input type="text" class="form-control" id="user_phone_no" name="user_phone_no" placeholder="Enter Phone Number">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                  <label>Email</label>
                                  <input type="text" class="form-control" id="user_email_id" name="user_email_id" placeholder="Enter Email">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Address Line 1</label>
                                    <input type="text" class="form-control" id="user_address_line_1" name="user_address_line_1" placeholder="Enter Address Line 1">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Address Line 2</label>
                                    <input type="text" class="form-control" id="user_address_line_2" name="user_address_line_2" placeholder="Enter Address Line 2">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>City</label>
                                    <input type="text" class="form-control" id="user_city" name="user_city" placeholder="Enter City">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>State</label>
                                    <input type="text" class="form-control" id="user_state" name="user_state" placeholder="Enter State">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Country</label>
                                    <input type="text" class="form-control" id="user_country" name="user_country" placeholder="Enter Country">
                                  </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="mb-3">
                                    <label>Zip Code</label>
                                    <input type="number" class="form-control" id="user_zip_code" name="user_zip_code" placeholder="Enter Zip Code">
                                  </div>
                              </div>
                              <div class="col-md-12">
                                  <div class="mb-3">
                                  <label>Qualifications</label>
                                  <input type="text" class="form-control" id="user_qualification" name="user_qualification" placeholder="Enter Qualifications">
                                  </div>
                              </div>
                              <div class="col-md-12">
                                  <div class="mb-3">
                                  <label>Description</label>
                                  <textarea class="form-control" id="user_description"  name="user_description" rows="3" placeholder="Enter Description"></textarea>
                                  </div>
                              </div>                             
                          </div>  
                        </form>
                      
                       
                 </div>
                   <div class="d-flex justify-content-between mt-3">
                    <div>
                        <span class="blue-border-btn">
                            <button type="button" class="btn btn-primary">
                              Cancel
                            </button>
                        </span>
                    </div>
                    <div class="d-flex justify-content-end">
                        <span class="blue-border-btn me-3">
                            <button onclick="hideStage(2);showStage(1)"><i class="fa fa-left"></i> Previous</button>
                        </span>
                        <span class="orange-btn">
                            <button id="save_user_details">Next <i class="fa fa-right"></i></button>
                        </span>
                    </div>
                    </div>
                </div>
                <!--stage two end-->

                <!--stage three start-->
                <div id="stage3" class="s-stepper-stage">
                    <div class="row">
                        <div class="col-md-6">
                           <div class="step-checkbox">
                            <div class="searchbar mb-2">
                                <h4>Select Stream</h4>
                              </div>
                              <div class="d-flex justify-content-start align-items-center step-search relative mb-3">
                                <i class="fas fa-search"></i> 
                                <input class="form-control form-control-dark w-100" type="text" placeholder="Enter Stream Name" aria-label="Search" id="stream_search">                                
                                <span style="white-space: nowrap;"><a class="orange-text" href="javascript:void(0);" data-bs-toggle="modal" data-bs-target="#addstreammodal"><i class="fas fa-plus"></i> Add</a></span>
                            </div>
                              <div id="ins_stream_list">
                                  <div class="mb-3 relative">
                                    <input type="checkbox" class="form-check-input" id="one" tabindex="3">
                                    <label for="one" class="form-label">Medical</label>
                                  </div>
                                  <div class="mb-3 relative">
                                    <input type="checkbox" class="form-check-input" id="two" tabindex="3">
                                    <label for="two" class="form-label">Pharmacology</label>
                                  </div>
                                  <div class="mb-3 relative">
                                    <input type="checkbox" class="form-check-input" id="three" tabindex="3">
                                    <label for="three" class="form-label">Nursing</label>
                                  </div>
                                  <div class="mb-3 relative">
                                    <input type="checkbox" class="form-check-input" id="one1" tabindex="3">
                                    <label for="one1" class="form-label">Medical</label>
                                  </div>
                                  <div class="mb-3 relative">
                                    <input type="checkbox" class="form-check-input" id="two2" tabindex="3">
                                    <label for="two2" class="form-label">Pharmacology</label>
                                  </div>
                                  <div class="mb-3 relative">
                                    <input type="checkbox" class="form-check-input" id="three3" tabindex="3">
                                    <label for="three3" class="form-label">Nursing</label>
                                  </div>
                                </div>
                           </div>
                        </div>
                        <div class="col-md-6">
                            <div class="step-checkbox">
                             <div class="searchbar mb-2">
                                 <h4>Select Course</h4>
                               </div>
                               <div class="d-flex justify-content-start align-items-center step-search relative mb-3">
                                 <i class="fas fa-search"></i> 
                                 <input class="form-control form-control-dark w-100" type="text" placeholder="Enter Course Name" aria-label="Search" id="course_search">
                             </div>
                                  <div id="ins_course_list">
                                   <div class="mb-3 relative">
                                     <input type="checkbox" class="form-check-input" id="one" tabindex="3">
                                     <label for="one" class="form-label">Medical</label>
                                   </div>
                                   <div class="mb-3 relative">
                                     <input type="checkbox" class="form-check-input" id="two" tabindex="3">
                                     <label for="two" class="form-label">Pharmacology</label>
                                   </div>
                                   <div class="mb-3 relative">
                                     <input type="checkbox" class="form-check-input" id="three" tabindex="3">
                                     <label for="three" class="form-label">Nursing</label>
                                   </div>
                                   <div class="mb-3 relative">
                                     <input type="checkbox" class="form-check-input" id="one1" tabindex="3">
                                     <label for="one1" class="form-label">Medical</label>
                                   </div>
                                   <div class="mb-3 relative">
                                     <input type="checkbox" class="form-check-input" id="two2" tabindex="3">
                                     <label for="two2" class="form-label">Pharmacology</label>
                                   </div>
                                   <div class="mb-3 relative">
                                     <input type="checkbox" class="form-check-input" id="three3" tabindex="3">
                                     <label for="three3" class="form-label">Nursing</label>
                                   </div>
                                </div>
                            </div>
                         </div>
                    </div>
                    <div class="d-flex justify-content-between mt-3">
                        <div>
                            <span class="blue-border-btn">
                                <button type="button" class="btn btn-primary">
                                  Cancel
                                </button>
                            </span>
                        </div>

                        <div class="d-flex justify-content-end">
                          <span class="blue-border-btn me-3">
                              <button onclick="hideStage(3);showStage(2)"><i class="fa fa-left"></i> Previous</button>
                          </span>
                          <span class="orange-btn">

                            <button id="toOrganizationList" data-n-linkto="institutelist" hidden></button>
                              <button id="save_manage_academic">Submit</button>
                          </span>
                        </div>
                    </div>
                </div>
                 <!--stage three end-->
            </div>

          </div>        
        </div>
    </div>
</div>



<!--add stream modal start-->
<div class="modal fade" id="addstreammodal" tabindex="-1" aria-labelledby="addstreammodalLabel" style="display: none;" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title h4" id="addstreammodalLabel">Add Stream</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="close_cms-stream"></button>
      </div>
      <div class="modal-body p-4">
        <form method="post" id="frmNewCmsStream" name="frmNewCmsStream" class="pop-form">
            <div class="mb-3">
              <label>Enter Stream Name</label>
              <input type="text" class="form-control" id="ins_stream_name" name="ins_stream_name" placeholder="Stream Name">
            </div>
            <div class="mb-3 mt-5 d-flex justify-content-end align-items-center">
              <div class="blue-border-btn"><button type="button" class="btn btn-primary" id="cancel_cms-stream">Cancle</button></div>
              <div class="orange-btn"><button type="submit" class="btn btn-primary ms-4" id="add_cms-stream">Add</button></div>
           </div>
        </form>
      </div>
    </div>
  </div>
</div>
<!--add stream modal end-->
<!-------------- Delete popup start --------------->
<div class="modal fade" id="delete-add" tabindex="-1" aria-labelledby="exampleModalCenterTitle" style="display: none;" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content delete_courseMadeFor">
      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      <div class="modal-body">
        <form method="get" class="pop-form">
          <div class="row">
            <div class="col-md-12 text-center mb-2"> <img src="../assets/images/delete.png"> </div>
            <div class="col-md-12 text-center mb-2" id="">
              <input type="hidden" id="mAlertURLcourseMadeFor" value="" />
              <input type="hidden" id="mAlertdeleteFor" value=""/>
              <p id="mAlertURLcourseMadeForname">Are you sure you want to delete it?</p>
            </div>
          </div>
          <div class="row">
            <div class="col-12 pt-3 pb-3 wauto text-center"> 
            <span class="danger-btn nbtn">
              <button type="button" id="mAlertDeletecourseMadeFor" class="btn btn-danger">Yes</button>
            </span>
            <span class="dborder-btn nbtn">
              <button type="button" id="mAlertCancelcourseMadeFor" class="btn btn-default" data-bs-dismiss="modal">Cancel</button>
            </span> 
            </div>
          </div>
        </form>
      </div>      
    </div>
  </div>
</div>
<!-------------- Delete popup end --------------->
<!--preview modal start-->
<div class="modal fade" id="previewmodal" tabindex="-1" aria-labelledby="exampleModalXlLabel" style="display: none;" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title h4" id="exampleModalXlLabel">Preview</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body p-4">
          <div class="pre-details">
            <div class="row">
              <div class="col-md-1"></div>
              <div class="col-md-2">
                  <div class="org-logo">
                      <img id="prev-org_logo" src="../assets/images/organization.png" alt="" />
                  </div>
              </div>
              <div class="col-md-6">
                  <div class="org-details">
                      <h2 id="prev-org_name">SRM Organization</h2>
                      <h4 id="prev-ins_name">SRM INSTITUTE OF SCIENCE AND TECHNOLOGY</h4>
                      <h6><a href="javascript:void(0);" id="prev-ins_website">www.srmuniversity.com</a></h6>
                      <p id="prev-org_code">SRM1250230</p>
                      <p id="prev-ins_address_line_1">3, Veerasamy St, Gokulam Colony, Ramakrishnapuram, </p>
                      <p id="prev-ins_address_line_2">West Mambalam</p>
                      <p id="prev-ins_city_state_zip">Chennai, Tamil Nadu 600033</p>
                      </p>
                  </div>                    
              </div>
              <div class="col-md-3 relative">
                <a id="prev-edit_icon" style="float:right;" data-bs-dismiss="modal"><i class="fas fa-edit"></i> Edit</a>
                <div class="" style="position: absolute;bottom:0;">
                    <p class="org-email ins_email_prev mb-3"><a href="javascript:void(0);" style="color:#344B6C;" id="prev-ins_email_id">srminfo@gmail.com</a></p>
                    <p class="org-phone ins_phone_prev"><a href="javascript:void(0);" style="color:#344B6C;" id="prev-ins_phone_no">044 2635 2563</a></p>
                </div>
              </div>
            </div>
            <div class="org-title mt-3 mb-3 p-2">
              <div class="row">
                <div class="col-md-1"></div>
                <div class="col-md-10">
                  <h4 id="prev-user_role">Admin</h4>
                </div>
                <div class="col-md-1"></div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-1"></div>
                <div class="col-md-2">
                    <div class="org-logo">
                        <img id="prev-user_profile_image" src="../assets/images/profile.png" alt="" />
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="org-details">
                        <h4 id="prev-user_name_qualification">Sri Harsha raj Kumar [ B.E ,ME,B.Ed ]</h4>
                        <p id="prev-user_role_ins">Principal</p>
                        <p id="prev-user_address_line_1">45, 3rd St, Sriram Colony, Abiramapuram, Chennai, Tamil Nadu 600018</p>
                        <p id="prev-user_address_line_2">3, Veerasamy St, Gokulam Colony, Ramakrishnapuram, </p>
                        <p id="prev-user_city_state_zip">Chennai, Tamil Nadu 600033</p>
                    </div>                    
                </div>
                <div class="col-md-3 relative">
                  <div class="" style="position: absolute;bottom:0;">
                      <p class="org-email user_email_prev mb-3"><a href="javascript:void(0);" style="color:#344B6C;" id="prev-user_email_id">srminfo@gmail.com</a></p>
                      <p class="org-phone user_phone_prev"><a href="javascript:void(0);" style="color:#344B6C;" id="prev-user_phone_no">044 2635 2563</a></p>
                  </div>
                </div>
                <div class="col-md-1"></div>
            </div>
            <div class="row">
              <div class="col-md-1"></div>
              <div class="col-md-10 mt-2">
                  <p id="prev-user_description">
                      discourse intended to give a mental image of something experienced. beautiful beyond description. 
                      gave an accurate description of what he saw. : a statement or account giving the characteristics
                      of someone or something : a descriptive statement or account.3
                  </p>
              </div>
              <div class="col-md-1"></div>
            </div>
            <div>
              <div class="row">
                <div class="col-md-1"></div>
                <div class="col-md-10 org-title mt-3 mb-3 p-2">
                  <h4>Manage Academic</h4>
                </div>
                <div class="col-md-1"></div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-3"></div>
              <div class="col-md-4">
                <div class="">
                  <div class="searchbar mb-3">
                    <h4>Select Stream</h4>
                  </div>
                  <div >
                    <ul class="mb-3 relative ul_item" id="prev-stream_list">
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="">
                  <div class="searchbar mb-3">
                      <h4>Select Course</h4>
                  </div>
                  <div>
                    <ul class="mb-3 relative ul_item" id="prev-course_list">
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-md-1"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--preview modal end-->



<script>

//var org_data = '';

/**** multistep form global functions Starts ****/
var cms_ins_param = getUrlParamquery();
console.log(cms_ins_param);
//var org_id = cms_ins_param.org_id;
var ins_id = cms_ins_param.ins_id;
var clg_id = cms_ins_param.clg_id;
var user_id = cms_ins_param.user_id;
var page_from = cms_ins_param.page_from;

var stream_list = function () {
  var tmp_stream = null;
  $.ajax({
    'async': false,
    url: API_BASE_URL + 'stream/details',
    type: 'get',
    global: false,
    dataType: 'json',
    headers: { "Content-type": "application/json; charset=UTF-8", "Authorization": "Bearer " + getUserInfo().access_token },
    success: function (response) {
      tmp_stream = response?.data;
    }
  }); 
  return tmp_stream;
}();

var course_list = function () {
  var tmp_course = null;
  $.ajax({
    'async': false,
    url: API_BASE_URL + 'course_type/details',
    type: 'get',
    global: false,
    dataType: 'json',
    headers: { "Content-type": "application/json; charset=UTF-8", "Authorization": "Bearer " + getUserInfo().access_token },
    success: function (response) {
      tmp_course = response?.data;
    }
  }); 
  return tmp_course;
}();
$(document).ready(function(){
  //hideStage(1);showStage(3);

  if(page_from){
    $("#toOrganizationList").attr("data-n-linkto", page_from);
  }
  if(clg_id){
    $("#save_manage_academic").attr("data-status", "Updated");
    $("#save_institute").text("Update & Next");
    $("#stage_head_1").text("Edit College");
    $("#stage_head_2").text("Edit Admin");
    $("#stage-1-step small").text("Edit College");
    $("#stage-2-step small").text("Edit Admin");
    $("#header_breadcrumbs").text("Organization / Institute / Edit College");
    $.ajax({
      url: API_BASE_URL + 'institute/details/'+clg_id+'/',
      type: "GET",
      headers: {
        "Authorization": "Bearer " + getUserInfo().access_token,
        "Content-Type": "application/json"
      },
      success:function(response){
        console.log(response)
        if(response){
            $("#ins_name").val(response.name ? response.name : "");
            $("#ins_website").val(response.website ? response.website : "");
            $("#ins_email_id").val(response.email_id ? response.email_id : "");
            $("#ins_address_line_1").val(response.address_line_1 ? response.address_line_1 : "");
            $("#ins_address_line_2").val(response.address_line_2 ? response.address_line_2 : "");
            $("#ins_city").val(response.city ? response.city : "");
            $("#ins_state").val(response.state ? response.state : "");
            $("#ins_country").val(response.country ? response.country : "");
            $("#ins_zip_code").val(response.zip_code ? response.zip_code : "");
            $("#ins_registration_details").val(response.registration_details ? response.registration_details : "");
            $("#ins_recogonition_details").val(response.recognition_detail ? response.recognition_detail : "");
            if(response.logo && response.logo !== ''){
              $(".dropzone_4_prev").attr("style", "display:block;");
              $(".dropzone_4_image_preview").attr('src', response.logo);
              $(".dropzone_4_image_preview").attr('style', "width: 100%;height: 250px;");
              $("#demo-upload_4 .dz-default").attr("id", "CourseSettingsBanner4");
              $("#demo-upload_4 .dz-default").after(`<img id="CourseSettingsBanner4del" class="delete_file" data-file_prop_name="Logo" data-bs-toggle="modal" data-bs-target="#delete-add" src="../assets/images/delete-round.png">`);
              //$("#CourseSettingsBanner4").attr("style", "opacity:1");
            }
            if(response.cover_image && response.cover_image !== ''){
              $(".dropzone_1_prev").attr("style", "display:block;");
              $(".dropzone_1_image_preview").attr('src', response.cover_image);
              $(".dropzone_1_image_preview").attr('style', "width: 100%;height: 250px;");
              $("#demo-upload_1 .dz-default").attr("id", "CourseSettingsBanner1");
              $("#demo-upload_1 .dz-default").after(`<img id="CourseSettingsBanner1del" class="delete_file" data-file_prop_name="Cover Image" data-bs-toggle="modal" data-bs-target="#delete-add" src="../assets/images/delete-round.png">`);
              //$("#CourseSettingsBanner4").attr("style", "opacity:1");
            }
            if(response.stream.length > 0){
              stream_list_select(stream_list, response.stream);
            }else{
              stream_list_select(stream_list, "");
            }
            if(response.course_type.length > 0){
              course_list_select(course_list, response.course_type);
            }else{
              course_list_select(course_list, "");
            }
            insertMobilenumberwithRegion(response.phone_number, response.region_code, "ins_phone_no");
            if(response.member_details.length > 0){
              $.each(response.member_details, function( i, val ) {
                if(i == 0){
                  if(val.id){
                    user_id = val.id;
                    var refresh = window.location.protocol + "//" + window.location.host + window.location.pathname + '?ins_id='+ins_id+'&clg_id='+clg_id+'&user_id='+user_id+"&page_from="+page_from;    
                    window.history.pushState({ path: refresh }, '', refresh);
                  }
                  insertMobilenumberwithRegion(val.mobile_number, val.region_code, "user_phone_no");
                  $("#user_first_name").val(val.first_name ? val.first_name : "");
                  $("#user_last_name").val(val.last_name ? val.last_name : "");
                  $("#user_email_id").val(val.email_id ? val.email_id : "");
                  $("#user_address_line_1").val(val.apartment_suit_unit ? val.apartment_suit_unit : "");
                  $("#user_address_line_2").val(val.street_address ? val.street_address : "");
                  $("#user_city").val(val.city ? val.city : "");
                  $("#user_state").val(val.state ? val.state : "");
                  $("#user_country").val(val.country ? val.country : "");
                  $("#user_zip_code").val(val.zip_code ? val.zip_code : "");
                  $("#user_qualification").val(val.qualification ? val.qualification : "");
                  $("#user_description").val(val.description ? val.description : "");
                  if(val.m_image && val.m_image !== ''){
                    $(".dropzone_2_prev").attr("style", "display:block;");
                    $(".dropzone_2_image_preview").attr('src', val.m_image);
                    $(".dropzone_2_image_preview").attr('style', "width: 100%;height: 250px;");
                    $("#demo-upload_2 .dz-default").attr("id", "CourseSettingsBanner2");
                    $("#demo-upload_2 .dz-default").after(`<img id="CourseSettingsBanner2del" class="delete_file" data-file_prop_name="Profile Image" data-bs-toggle="modal" data-bs-target="#delete-add" src="../assets/images/delete-round.png">`);
                    //$("#CourseSettingsBanner4").attr("style", "opacity:1");
                  }
                }
              });
            }else{
              initiateMobilenumberwithRegion("user_phone_no");
            }
        }
      },
      error: function(error) {
        if (error.status === 401) {
          alert("Session Expired, Please login again.");
          logoutSession();
        }
        //toastr.error("Response Error: " + error.message);
        console.log(error);
      }
    });
  }else{
    $("#save_institute").text("Save & Next");
    $("#save_manage_academic").attr("data-status", "Saved");
    $("#stage_head_1").text("Create College");
    $("#stage_head_2").text("Create Admin");
    $("#stage-1-step small").text("Create College");
    $("#stage-2-step small").text("Create Admin");
    $("#header_breadcrumbs").text("Organization / Institute / Add College");
    initiateMobilenumberwithRegion("ins_phone_no");
    initiateMobilenumberwithRegion("user_phone_no");
    stream_list_select(stream_list, "");
    course_list_select(course_list, "");
  }
});
function initiateMobilenumberwithRegion(field_id){
  var input = document.getElementById(field_id);
  window.intlTelInput(input, {
      separateDialCode: true,
      initialCountry:"in",
      utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/javascript.util/0.12.12/javascript.util.min.js" // just for formatting/placeholders etc
  });
}
function insertMobilenumberwithRegion(mobile_number, region_code, field_id){
  if(mobile_number && mobile_number != "" && mobile_number != null){
    console.log('mobile_number');
    var region_code = region_code != "" && region_code != null ? region_code+" " : '+91 ';
    $("#"+field_id).val(region_code+mobile_number);
    var input = document.getElementById(field_id);
    window.intlTelInput(input, {
      utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/javascript.util/0.12.12/javascript.util.min.js" // just for formatting/placeholders etc
    });
    $(".iti--allow-dropdown").addClass("iti--separate-dial-code");
    $("#"+field_id).val(mobile_number);
  }else{
    var input = document.getElementById(field_id);
    window.intlTelInput(input, {
        separateDialCode: true,
        initialCountry:"in",
        utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/javascript.util/0.12.12/javascript.util.min.js" // just for formatting/placeholders etc
      });
  }
}
//dropzone delete icon click function
$(document).on("click", ".delete_file", function(e){
  var name =  $(this).attr("data-file_prop_name");
    $("#mAlertURLcourseMadeForname").text("Are you sure want to delete "+name+"?");
    if(name == "Logo"){
      $("#mAlertdeleteFor").val("org_logo");
    }else if(name == "Cover Image"){
      $("#mAlertdeleteFor").val("cover_image");
    }else if(name == "Profile Image"){
      $("#mAlertdeleteFor").val("profile_image");
    }
  });

//delete file confirmation popup
$("#mAlertDeletecourseMadeFor").on("click", function(){
  var deleteFor = $("#mAlertdeleteFor").val();
  if(deleteFor == "org_logo"){
      updateCourseSettingsFile("org_logo", null); 
  }
  if(deleteFor == "cover_image"){
    updateCourseSettingsFile("cover_image", null); 
  }
  if(deleteFor == "profile_image"){
    updateCourseSettingsFile("profile_image", null); 
  }
});

//delete confirmation popup call remove uploaded files and related changes
function updateCourseSettingsFile(inpLabel, inpValue){
  if(inpLabel == "org_logo"){
    $("#demo-upload_4 .dz-default").attr("id", "CourseSettingsBanner");
    $("#demo-upload_4 .dz-default").empty();
    $(".dropzone_4_image_preview").attr("src", "");
    $(".dropzone_4_image_preview").attr("style", "display:none;");
    $("#CourseSettingsBanner4del").remove();
    dropzone_4.removeAllFiles(true); 
    currentLogoFile = "";
  }
  if(inpLabel == "cover_image"){
    $("#demo-upload_1 .dz-default").attr("id", "CourseSettingsBanner");
    $("#demo-upload_1 .dz-default").empty();
    $(".dropzone_1_image_preview").attr("src", "");
    $(".dropzone_1_image_preview").attr("style", "display:none;");
    $("#CourseSettingsBanner1del").remove();
    dropzone_1.removeAllFiles(true); 
    currentCoverFile = "";
  }
  if(inpLabel == "profile_image"){
    $("#demo-upload_2 .dz-default").attr("id", "CourseSettingsBanner");
    $("#demo-upload_2 .dz-default").empty();
    $(".dropzone_2_image_preview").attr("src", "");
    $(".dropzone_2_image_preview").attr("style", "display:none;");
    $("#CourseSettingsBanner2del").remove();
    dropzone_2.removeAllFiles(true); 
    currentProfileFile = "";
  }
  $(".btn-close").trigger("click");
}
/**** multistep form global functions Ends ****/

/**** Institute section Starts ****/
//dropzone with image upload for Institute logo
//var acceptedFiles_image = "image/jpeg,image/png,image/jpg,image/svg+xml,";
var acceptedFiles_image = "image/jpeg,image/png,image/jpg,";
var currentLogoFile = null;
acceptedFiles_image = acceptedFiles_image.replace(/,\s*$/, "");
var dropzone_4options = {
  previewTemplate: document.querySelector('#preview-template_4').innerHTML,
  parallelUploads: 1,
  thumbnailHeight: 250,
  thumbnailWidth: 470,
  maxFilesize: 4,
  maxFiles:1,
  filesizeBase: 1000,
  autoProcessQueue: false,
  acceptedFiles: acceptedFiles_image,
   init: function ()  {
    this.hiddenFileInput.removeAttribute('multiple');
      this.on("error", function (file, message) {
          if (file.size > this.options.maxFilesize * 1000 * 1000) {
            this.removeFile(file);
          }
          var split_str = acceptedFiles_image.split(",");
          if (split_str.indexOf(file.type) === -1 && file.size > this.options.maxFilesize * 1000 * 1000) {
            toastr.error("Accepts only images");
            this.removeFile(file);
            return true;
          }
          if(message.substring(0,16) == "You can't upload" ){
            toastr.error("Accepts only images");
            this.removeFile(file);
            return true;
          }
      }); 
      this.on("addedfile", function(file) {
        $("#CourseSettingsBanner4del").remove();
        if (currentLogoFile) {
          this.removeFile(currentLogoFile);
        }
        currentLogoFile = file;
      });
  },
  thumbnail: function(file, dataUrl) {
      if (file.size > this.options.maxFilesize * 1000 * 1000) {
          toastr.error("File size is too big, Max file size allowed is 4MB");
          return true;
      }
      if (file.previewElement) {
        file.previewElement.classList.remove("dz-file-preview");
        var images = file.previewElement.querySelectorAll("[data-dz-thumbnail]");
        for (var i = 0; i < images.length; i++) {
            var thumbnailElement = images[i];
            thumbnailElement.alt = file.name;
            thumbnailElement.src = dataUrl;
            $("#dropzoneTestimonial").next().remove(); 
            $(".dropzone_4_prev").attr("style", "display:block;");
            $(".dropzone_4_image_preview").attr('src', dataUrl);
            $(".dropzone_4_image_preview").attr('style', "width: 100%;height: 250px;");
            $("#demo-upload_4 .dz-default").attr("id", "CourseSettingsBanner4");
            $("#demo-upload_4 .dz-default").after(`<img id="CourseSettingsBanner4del" class="delete_file" data-file_prop_name="Logo" data-bs-toggle="modal" data-bs-target="#delete-add" src="../assets/images/delete-round.png">`);
        }
        file.previewElement.classList.add("dz-image-preview");
      }
  }
};
var dropzone_4 = new Dropzone('#demo-upload_4', dropzone_4options);
$("#demo-upload_4 .dz-default").attr("id", "CourseSettingsBanner");
$("#demo-upload_4 .dz-default").empty();

//dropzone with image upload for Institute Cover Image
var currentCoverFile = null;
var dropzone_1options = {
  previewTemplate: document.querySelector('#preview-template_1').innerHTML,
  parallelUploads: 1,
  thumbnailHeight: 250,
  thumbnailWidth: 960,
  maxFilesize: 4,
  maxFiles:1,
  filesizeBase: 1000,
  autoProcessQueue: false,
  acceptedFiles: acceptedFiles_image,
   init: function ()  {
    this.hiddenFileInput.removeAttribute('multiple');
      this.on("error", function (file, message) {
          if (file.size > this.options.maxFilesize * 1000 * 1000) {
            this.removeFile(file);
          }
          var split_str = acceptedFiles_image.split(",");
          if (split_str.indexOf(file.type) === -1 && file.size > this.options.maxFilesize * 1000 * 1000) {
            toastr.error("Accepts only images");
            this.removeFile(file);
            return true;
          }
          if(message.substring(0,16) == "You can't upload" ){
            toastr.error("Accepts only images");
            this.removeFile(file);
            return true;
          }
      }); 
      this.on("addedfile", function(file) {
        $("#CourseSettingsBanner1del").remove();
        if (currentCoverFile) {
          this.removeFile(currentCoverFile);
        }
        currentCoverFile = file;
      });
  },
  thumbnail: function(file, dataUrl) {
      if (file.size > this.options.maxFilesize * 1000 * 1000) {
          toastr.error("File size is too big, Max file size allowed is 4MB");
          return true;
      }
      if (file.previewElement) {
        file.previewElement.classList.remove("dz-file-preview");
        var images = file.previewElement.querySelectorAll("[data-dz-thumbnail]");
        for (var i = 0; i < images.length; i++) {
            var thumbnailElement = images[i];
            thumbnailElement.alt = file.name;
            thumbnailElement.src = dataUrl;
            $("#dropzoneTestimonial").next().remove(); 
            $(".dropzone_1_prev").attr("style", "display:block;");
            $(".dropzone_1_image_preview").attr('src', dataUrl);
            $(".dropzone_1_image_preview").attr('style', "width: 100%;height: 250px;");
            $("#demo-upload_1 .dz-default").attr("id", "CourseSettingsBanner1");
            $("#demo-upload_1 .dz-default").after(`<img id="CourseSettingsBanner1del" class="delete_file" data-file_prop_name="Cover Image" data-bs-toggle="modal" data-bs-target="#delete-add" src="../assets/images/delete-round.png">`);
        }
        file.previewElement.classList.add("dz-image-preview");
      }
  }
};

// Form validation
$.urlParam = function(name, parameter){
  var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(parameter);
  if (results==null) {
     return null;
  }
  return decodeURI(results[1]) || 0;
}
var frmvalidatorfrm;
var frmvalidatorfrmUser;
var frmvalidatorfrmStream;
$.validator.addMethod("pattern", function (value, element, param) {
  if (this.optional(element)) { return true; }
  if (typeof param === "string") {
    param = new RegExp("^(?:" + param + ")$");
  }
  return param.test(value);
}, "Check your inputs");
var frmvalidatorfrm = $("#frmNewCmsIns").validate({
  ignore:'',
  rules: {
    ins_name: { required: true, minlength: 1, maxlength: 256 },
    ins_website: { required: false, url: true},
    ins_phone_no: { required: false, minlength: 10, maxlength: 10 },
    ins_email_id: { required: true, email: true },
    //ins_address_line_1: { required: false},
    //ins_address_line_2: { required: false},
    //ins_city: { required: false},
    //ins_state: { required: false},
    //ins_country: { required: false},
    ins_zip_code: { required: false, minlength: 6, maxlength: 6 },
    //ins_registration_details: { required: false },
    //ins_recogonition_details: { required: false },
  },
  messages: {
    ins_name: {
      required: "Please enter College Name",
      minlength: "College Name must consist of at least 1 characters",
      maxlength: "College Name must consist of max of 256 characters",
    },
    ins_website: {
      url: "Enter Valid Website",
    },
    ins_phone_no: {
      minlength: "Enter Valid Phone Number",
      maxlength: "Enter Valid Phone Number",
    },
    ins_email_id: {
      required: "Please enter Email",
      minlength: "Email must consist of at least 1 characters",
      maxlength: "Email must consist of max of 256 characters",
    },
    ins_zip_code: {
      minlength: "Enter valid Zip Code",
      maxlength: "Enter valid Zip Code",
    },
  },
  errorElement: "em",
  errorPlacement: function (error, element) {
    error.addClass("help-block");
    if (element.prop("type") === "checkbox") {
      error.insertAfter(element.parent("label"));
    } else {
      error.insertAfter(element);
    }
    if (element.attr("type") == "radio") {
        error.insertAfter(element.parent().parent());
    } else {
        error.insertAfter(element);
    }
    if (element.attr("name") == "ins_phone_no") {
        error.insertAfter($("#ins_phone_no").closest(".iti--allow-dropdown"));
    }
  },
  highlight: function (element, errorClass, validClass) {
    if (element.getAttribute("name") == "ins_phone_no") {
      $("#ins_phone_no").addClass("is-invalid");
    }else{
      $(element).addClass("is-invalid");
    }
  },
  unhighlight: function (element, errorClass, validClass) {
    if (element.getAttribute("name") == "ins_phone_no") {
      $("#ins_phone_no").removeClass("is-invalid");
    }else{
      $(element).removeClass("is-invalid");
    }
  }
});

$("#save_institute").on("click", function () {
  var current_element = $(this);
  current_element.prop('disabled', true);

  var logo_file = $('#demo-upload_4').get(0).dropzone.getAcceptedFiles();
  var cover_file = $('#demo-upload_1').get(0).dropzone.getAcceptedFiles();
  var isValidForm = frmvalidatorfrm.form();
  var logofile_exist = 0;
  var coverfile_exist = 0;
  console.log(clg_id);
  console.log(logo_file.length);
  console.log($(".dropzone_1_image_preview").attr("src"));
  if(!clg_id){
    if(logo_file.length > 0){
      logofile_exist++;
    }else{
      toastr.error("Add Logo Image.");
    }
    if(cover_file.length > 0){
      coverfile_exist++;
    }else{
      toastr.error("Add Cover Image.");
    }
  }else{
    if(logo_file.length > 0 || $(".dropzone_4_image_preview").attr("src") != ""){
      logofile_exist++;
    }else{
      toastr.error("Add Logo Image.");
    }
    if(cover_file.length > 0 || $(".dropzone_1_image_preview").attr("src") != ""){
      coverfile_exist++;
    }else{
      toastr.error("Add Cover Image.");
    }
  }
  if (isValidForm && logofile_exist > 0 && coverfile_exist > 0) {

    var ins_phone_no = $("#ins_phone_no").val() ? $("#ins_phone_no").val() : "";
    var input_phone_no = document.querySelector('#ins_phone_no');
    var iti = window.intlTelInputGlobals.getInstance(input_phone_no);
    var region_code = iti.getSelectedCountryData();
    console.log(region_code.dialCode);
    var formData = new FormData();
    formData.append("name", $("#ins_name").val() ? $("#ins_name").val() : "");
    formData.append("website", $("#ins_website").val() ? $("#ins_website").val() : "");
    formData.append("mobile_number", ins_phone_no);
    if(ins_phone_no){
      formData.append("region_code", "+"+region_code.dialCode);
    }else{
      formData.append("region_code", "");
    }
    formData.append("email_id", $("#ins_email_id").val() ? $("#ins_email_id").val() : "");
    formData.append("address_line_1", $("#ins_address_line_1").val() ? $("#ins_address_line_1").val() : "");
    formData.append("address_line_2", $("#ins_address_line_2").val() ? $("#ins_address_line_2").val() : "");
    formData.append("city", $("#ins_city").val() ? $("#ins_city").val() : "");
    formData.append("state", $("#ins_state").val() ? $("#ins_state").val() : "");
    formData.append("country", $("#ins_country").val() ? $("#ins_country").val() : "");
    formData.append("zip_code", $("#ins_zip_code").val() ? $("#ins_zip_code").val() : "");
    //formData.append("organization_id", org_id);
    formData.append("registration_details", $("#ins_registration_details").val() ? $("#ins_registration_details").val() : "");
    formData.append("recognition_detail", $("#ins_recogonition_details").val() ? $("#ins_recogonition_details").val() : "");
    //console.log(files);
    if(logo_file && logo_file.length > 0){
      $.each(logo_file, function (i, file) {
        //formData.append("image", file, file.name);
        //formData.append("image_name", file.name);
        formData.append("logo", file);
      });
    }
    if(cover_file && cover_file.length > 0){
      $.each(cover_file, function (i, file) {
        //formData.append("image", file, file.name);
        //formData.append("image_name", file.name);
        formData.append("cover_image", file);
      });
    }
    var URL = API_BASE_URL + "create_child_institute/"+ins_id+"/";
    var method = "POST";
    var type = "POST";
    if(clg_id != "" && clg_id != null && clg_id != undefined){
      method = "PUT";
      type = "PUT";
      URL = API_BASE_URL + "institute_basic_update/"+clg_id+"/";
    }
    $.ajax({
      url: URL,
      method: method,
      type: type, // For jQuery < 1.9
      cache: false,
      contentType: false,
      processData: false,
      data: formData,
      headers: {
        "Authorization": "Bearer " + getUserInfo().access_token
      },
      success: function (response) {
        clg_id = response.institute_id;
        var user_param = "";
        if(user_id){
          user_param = "&user_id="+user_id;
        }
        console.log(ins_id);
        var refresh = window.location.protocol + "//" + window.location.host + window.location.pathname + '?ins_id='+ins_id+'&clg_id='+clg_id+"&page_from="+page_from+user_param;    
        window.history.pushState({ path: refresh }, '', refresh);
        current_element.removeAttr("disabled");
        hideStage(1);showStage(2);
      },
      error: function (error) {
        var errorJson = jQuery.parseJSON(error.responseText);
        console.log(errorJson);
        if(errorJson){
          toastr.error(errorJson);
        }
        current_element.removeAttr("disabled");
      } 
    });
  }else{
    current_element.removeAttr("disabled");
  }
});
/**** Institute section Ends ****/
/**** Admin section Starts ****/

var dropzone_1 = new Dropzone('#demo-upload_1', dropzone_1options);
$("#demo-upload_1 .dz-default").attr("id", "CourseSettingsBanner");
$("#demo-upload_1 .dz-default").empty();

//dropzone with image upload for User Profile Image
var currentProfileFile = null;
var dropzone_2options = {
  previewTemplate: document.querySelector('#preview-template_2').innerHTML,
  parallelUploads: 1,
  thumbnailHeight: 250,
  thumbnailWidth: 960,
  maxFilesize: 4,
  maxFiles:1,
  filesizeBase: 1000,
  autoProcessQueue: false,
  acceptedFiles: acceptedFiles_image,
   init: function ()  {
    this.hiddenFileInput.removeAttribute('multiple');
      this.on("error", function (file, message) {
          if (file.size > this.options.maxFilesize * 1000 * 1000) {
            this.removeFile(file);
          }
          var split_str = acceptedFiles_image.split(",");
          if (split_str.indexOf(file.type) === -1 && file.size > this.options.maxFilesize * 1000 * 1000) {
            toastr.error("Accepts only images");
            this.removeFile(file);
            return true;
          }
          if(message.substring(0,16) == "You can't upload" ){
            toastr.error("Accepts only images");
            this.removeFile(file);
            return true;
          }
      }); 
      this.on("addedfile", function(file) {
        $("#CourseSettingsBanner2del").remove();
        if (currentProfileFile) {
          this.removeFile(currentProfileFile);
        }
        currentProfileFile = file;
      });
  },
  thumbnail: function(file, dataUrl) {
      if (file.size > this.options.maxFilesize * 1000 * 1000) {
          toastr.error("File size is too big, Max file size allowed is 4MB");
          return true;
      }
      if (file.previewElement) {
        file.previewElement.classList.remove("dz-file-preview");
        var images = file.previewElement.querySelectorAll("[data-dz-thumbnail]");
        for (var i = 0; i < images.length; i++) {
            var thumbnailElement = images[i];
            thumbnailElement.alt = file.name;
            thumbnailElement.src = dataUrl;
            //$("#dropzoneTestimonial").next().remove(); 
            $(".dropzone_2_prev").attr("style", "display:block;");
            $(".dropzone_2_image_preview").attr('src', dataUrl);
            $(".dropzone_2_image_preview").attr('style', "width: 100%;height: 250px;");
            $("#demo-upload_2 .dz-default").attr("id", "CourseSettingsBanner2");
            $("#demo-upload_2 .dz-default").after(`<img id="CourseSettingsBanner2del" class="delete_file" data-file_prop_name="Profile Image" data-bs-toggle="modal" data-bs-target="#delete-add" src="../assets/images/delete-round.png">`);
        }
        file.previewElement.classList.add("dz-image-preview");
      }
  }
};
var dropzone_2 = new Dropzone('#demo-upload_2', dropzone_2options);
$("#demo-upload_2 .dz-default").attr("id", "CourseSettingsBanner");
$("#demo-upload_2 .dz-default").empty();

var frmvalidatorfrmUser = $("#frmNewCmsUser").validate({
  ignore:'',
  rules: {
    user_first_name: { required: true, minlength: 1, maxlength: 256 },
    //user_last_name: { required: false},
    user_phone_no: { required: false, minlength: 10, maxlength: 10 },
    user_email_id: { required: true, email: true },
    //user_address_line_1: { required: false},
    //user_address_line_2: { required: false},
    //user_city: { required: false},
    //user_state: { required: false},
    //user_country: { required: false},
    user_zip_code: { required: false, minlength: 6, maxlength: 6 },
    //user_qualification: { required: false },
    //user_description: { required: false },
  },
  messages: {
    user_first_name: {
      required: "Please enter First Name",
      minlength: "FIrst Name must consist of at least 1 characters",
      maxlength: "First Name must consist of max of 256 characters",
    },
    user_phone_no: {
      minlength: "Enter Valid Phone Number",
      maxlength: "Enter Valid Phone Number",
    },
    user_email_id: {
      required: "Please enter Email",
      minlength: "Email must consist of at least 1 characters",
      maxlength: "Email must consist of max of 256 characters",
    },
    user_zip_code: {
      minlength: "Enter valid Zip Code",
      maxlength: "Enter valid Zip Code",
    },
    ins_organization: {
      required: "Please select Organization",
    }
  },
  errorElement: "em",
  errorPlacement: function (error, element) {
    error.addClass("help-block");
    if (element.prop("type") === "checkbox") {
      error.insertAfter(element.parent("label"));
    } else {
      error.insertAfter(element);
    }
    if (element.attr("type") == "radio") {
        error.insertAfter(element.parent().parent());
    } else {
        error.insertAfter(element);
    }
    if (element.attr("name") == "user_phone_no") {
        error.insertAfter($("#user_phone_no").closest(".iti--allow-dropdown"));
    }
  },
  highlight: function (element, errorClass, validClass) {
    if (element.getAttribute("name") == "user_phone_no") {
      $("#user_phone_no").addClass("is-invalid");
    }else{
      $(element).addClass("is-invalid");
    }
  },
  unhighlight: function (element, errorClass, validClass) {
    if (element.getAttribute("name") == "user_phone_no") {
      $("#user_phone_no").removeClass("is-invalid");
    }else{
      $(element).removeClass("is-invalid");
    }
  }
});

$("#save_user_details").on("click", function () {
  var current_element = $(this);
  current_element.prop('disabled', true);

  var profile_file = $('#demo-upload_2').get(0).dropzone.getAcceptedFiles();
  var isValidForm = frmvalidatorfrmUser.form();
  var profilefile_exist = 0;
  if(!user_id){
    if(profile_file.length > 0){
      profilefile_exist++;
    }else{
      toastr.error("Add Profile Image.");
    }
  }else{
    if(profile_file.length > 0 || $(".dropzone_2_image_preview").attr("src") != ""){
      profilefile_exist++;
    }else{
      toastr.error("Add Profile Image.");
    }
  }
  if (isValidForm && profilefile_exist > 0) {

    var user_phone_no = $("#user_phone_no").val() ? $("#user_phone_no").val() : "";
    var input_phone_no = document.querySelector('#user_phone_no');
    var iti = window.intlTelInputGlobals.getInstance(input_phone_no);
    var region_code = iti.getSelectedCountryData();
    console.log(region_code.dialCode);
    var org_id = $("#ins_organization").val() ? $("#ins_organization").val() : org_id;
    var formData = new FormData();
    formData.append("first_name", $("#user_first_name").val() ? $("#user_first_name").val() : "");
    formData.append("last_name", $("#user_last_name").val() ? $("#user_last_name").val() : "");
    formData.append("mobile_number", user_phone_no);
    if(user_phone_no){
      formData.append("region_code", "+"+region_code.dialCode);
    }else{
      formData.append("region_code", "");
    }
    formData.append("roles", "Admin");
    formData.append("email_id", $("#user_email_id").val() ? $("#user_email_id").val() : "");
    formData.append("apartment_suit_unit", $("#user_address_line_1").val() ? $("#user_address_line_1").val() : "");
    formData.append("address", $("#user_address_line_2").val() ? $("#user_address_line_2").val() : "");
    formData.append("city", $("#user_city").val() ? $("#user_city").val() : "");
    formData.append("state", $("#user_state").val() ? $("#user_state").val() : "");
    formData.append("country", $("#user_country").val() ? $("#user_country").val() : "");
    formData.append("zip_code", $("#user_zip_code").val() ? $("#user_zip_code").val() : "");
    //formData.append("organization_id", org_id);
    formData.append("institute_id", clg_id);
    formData.append("qualification", $("#user_qualification").val() ? $("#user_qualification").val() : "");
    formData.append("description", $("#user_description").val() ? $("#user_description").val() : "");
    //console.log(files);
    if(profile_file && profile_file.length > 0){
      $.each(profile_file, function (i, file) {
        //formData.append("image", file, file.name);
        //formData.append("image_name", file.name);
        formData.append("profile_image", file);
      });
    }
    var URL = API_BASE_URL + "user/create/";
    var method = "POST";
    var type = "POST";
    if(user_id != "" && user_id != null && user_id != undefined){
      method = "PUT";
      type = "PUT";
      URL = API_BASE_URL + "user/update/"+user_id+"/";
    }
    $.ajax({
      url: URL,
      method: method,
      type: type, // For jQuery < 1.9
      cache: false,
      contentType: false,
      processData: false,
      data: formData,
      headers: {
        "Authorization": "Bearer " + getUserInfo().access_token
      },
      success: function (response) {
        user_id = response.member_id;
        var refresh = window.location.protocol + "//" + window.location.host + window.location.pathname + '?ins_id='+ins_id+'&clg_id='+clg_id+'&user_id='+user_id+"&page_from="+page_from;    
        window.history.pushState({ path: refresh }, '', refresh);
        current_element.removeAttr("disabled");
        hideStage(2);showStage(3);
      },
      error: function (error) {

        var errorJson = jQuery.parseJSON(error.responseText);
        console.log(errorJson);
        if(errorJson){
          toastr.error(errorJson);
        }
        current_element.removeAttr("disabled");
      } 
    });
  }else{
    //hideStage(2);showStage(3);
    current_element.removeAttr("disabled");
  }
});
/**** Admin section Ends ****/
/*** Manage Academic section Starts ***/

function stream_list_select(stream_list_data, stream_selected_list){
  
  $("#ins_stream_list").empty();
  var stream_list = "";
  $.each(stream_list_data, function( i, val ) {
    if (stream_selected_list && stream_selected_list.find(e => e.id === val.id)) {
      stream_list +=`<div class="mb-3 relative">
                      <input type="checkbox" class="form-check-input stream_options" id="${val.id}" data-item_name="${val.name}" tabindex="${i}" checked>
                      <label for="${val.id}" class="form-label stream_options_label">${val.name}</label>
                    </div>`;
    }else{
      stream_list +=`<div class="mb-3 relative">
                      <input type="checkbox" class="form-check-input stream_options" id="${val.id}" data-item_name="${val.name}" tabindex="${i}">
                      <label for="${val.id}" class="form-label stream_options_label">${val.name}</label>
                    </div>`;
    }
  });
  $("#ins_stream_list").append(stream_list);
}
function course_list_select(course_list_data, course_selected_list){
  
  $("#ins_course_list").empty();
  var course_list = "";
  $.each(course_list_data, function( i, val ) {
    if (course_selected_list && course_selected_list.find(e => e.id === val.id)) {
      course_list +=`<div class="mb-3 relative">
                    <input type="checkbox" class="form-check-input course_options" id="${val.id}" data-item_name="${val.name}" tabindex="${i}" checked>
                    <label for="${val.id}" class="form-label course_options_label">${val.name}</label>
                  </div>`;
    }else{
      course_list +=`<div class="mb-3 relative">
        <input type="checkbox" class="form-check-input course_options" id="${val.id}" data-item_name="${val.name}" tabindex="${i}">
        <label for="${val.id}" class="form-label course_options_label">${val.name}</label>
      </div>`;
    }
  });
  $("#ins_course_list").append(course_list);
}
$("#stream_search").on("propertychange input", function(e){
  var valueChanged = false;

  if (e.type=='propertychange') {
      valueChanged = e.originalEvent.propertyName=='value';
  } else {
      valueChanged = true;
  }
  if (valueChanged) {
      
    var searched_val = $(this).val().trim().toLowerCase();
    $('.stream_options').parent().removeClass("d-none");
    $('.stream_options').each(function () {
      var list_element_value = $(this).attr("data-item_name").trim().toLowerCase();
      if(list_element_value.search(searched_val) == -1){
        $(this).parent().addClass("d-none");
      }
    });
  }
});

$("#course_search").on("propertychange input", function(e){
  var valueChanged = false;

  if (e.type=='propertychange') {
      valueChanged = e.originalEvent.propertyName=='value';
  } else {
      valueChanged = true;
  }
  if (valueChanged) {
      
    var searched_val = $(this).val().trim().toLowerCase();
    $('.course_options').parent().removeClass("d-none");
    $('.course_options').each(function () {
      var list_element_value = $(this).attr("data-item_name").trim().toLowerCase();
      if(list_element_value.search(searched_val) == -1){
        $(this).parent().addClass("d-none");
      }
    });
  }
});
var frmvalidatorfrmStream = $("#frmNewCmsStream").validate({
  ignore:'',
  rules: {
    ins_stream_name: { required: true, minlength: 1, maxlength: 256 },
  },
  messages: {
    ins_stream_name: {
      required: "Please enter Stream Name",
      minlength: "Stream Name must consist of at least 1 characters",
      maxlength: "Stream Name must consist of max of 256 characters",
    },
  },
  errorElement: "em",
  errorPlacement: function (error, element) {
    error.addClass("help-block");
    if (element.prop("type") === "checkbox") {
      error.insertAfter(element.parent("label"));
    } else {
      error.insertAfter(element);
    }
    if (element.attr("type") == "radio") {
        error.insertAfter(element.parent().parent());
    } else {
        error.insertAfter(element);
    }
  },
  highlight: function (element, errorClass, validClass) {
    $(element).addClass("is-invalid");
  },
  unhighlight: function (element, errorClass, validClass) {
    $(element).removeClass("is-invalid");
  }
});
$("#cancel_cms-stream").click(function(){
  $("#close_cms-stream").trigger("click");
});
$("#close_cms-stream").click(function(){
  //$('#add-cms_org').prop('disabled', false);
  $( '#frmNewCmsStream' ).each(function(){
      this.reset();
      frmvalidatorfrmStream.resetForm();
      $('#frmNewCmsStream .form-control').removeClass('is-invalid');
      $('#ins_stream_name').val('');
  });

  $("#add_cms-stream").text("Add");
  $("#add_cms-stream").attr("data-org_id", "");
  $('#addstreammodal').modal('hide');
});

$("#add_cms-stream").on("click", function () {
  var current_element = $(this);
  current_element.prop('disabled', true);
  var isValidForm = frmvalidatorfrmStream.form();
  if (isValidForm) {
    var ins_stream_name = $("#ins_stream_name").val();
    var formData = new FormData();
    formData.append("name", $("#ins_stream_name").val());
    var URL = API_BASE_URL + "stream/create";
    var method = "POST";
    var type = "POST";
    $.ajax({
      url: URL,
      method: method,
      type: type, // For jQuery < 1.9
      cache: false,
      contentType: false,
      processData: false,
      data: formData,
      headers: {
        "Authorization": "Bearer " + getUserInfo().access_token
      },
      success: function (response) {
        current_element.removeAttr("disabled");
        if(method == "POST"){
          toastr.success("Stream added successfully.");
        }else{
          toastr.success("Stream updated successfully.");
        }
        if(response && response?.status == "success" && response?.stream_id){
            var stream_list =`<div class="mb-3 relative">
                              <input type="checkbox" class="form-check-input stream_options" id="${response?.stream_id}" data-item_name="${ins_stream_name}">
                              <label for="${response?.stream_id}" class="form-label stream_options_label">${ins_stream_name}</label>
                            </div>`;
            
          $("#ins_stream_list").append(stream_list);
        }
        $("#close_cms-stream").trigger("click");
        //window.sharedEditCourseId = "";
      },
      error: function (error) {

        var errorJson = jQuery.parseJSON(error.responseText);
        console.log(errorJson);
        if(errorJson){
          toastr.error(errorJson);
        }
        current_element.removeAttr("disabled");
      } 
    });
  }else{
    current_element.removeAttr("disabled");
  }
});

$("#save_manage_academic").on("click", function () {
  var current_element = $(this);
  current_element.prop('disabled', true);
  var stream_selected_checkbox = [];
  $('.stream_options:checked').each(function () {
    stream_selected_checkbox.push($(this).attr('id'))
  });
  if(stream_selected_checkbox.length ==  0){
    toastr.error("Select any Stream");
  }
  var course_selected_checkbox = [];
  $('.course_options:checked').each(function () {
    course_selected_checkbox.push($(this).attr('id'))
  });
  if(course_selected_checkbox.length == 0){
    toastr.error("Select any Course");
  }
  if (stream_selected_checkbox.length > 0 && course_selected_checkbox.length > 0) {

    //var formData = new FormData();
    //formData.append("stream", JSON.stringify(stream_selected_checkbox));
    //formData.append("course_type", JSON.stringify(course_selected_checkbox));
    var URL = API_BASE_URL + "manage_academic/"+clg_id+'/';
    var method = "PATCH";
    var type = "PATCH";
    $.ajax({
      url: URL,
      method: method,
      type: type, // For jQuery < 1.9
      cache: false,
      contentType: "application/json",
      processData: false,
      data: JSON.stringify({
        "stream": stream_selected_checkbox,
        "course_type": course_selected_checkbox
      }),
      headers: {
        "Authorization": "Bearer " + getUserInfo().access_token
      },
      success: function (response) {
        $("#toOrganizationList").trigger("click");
        if(current_element.attr("data-status")){
          toastr.success("College "+current_element.attr("data-status")+" Successfully");
        }else{
          toastr.success("College Created Successfully");
        }
        current_element.removeAttr("disabled");
      },
      error: function (error) {

        var errorJson = jQuery.parseJSON(error.responseText);
        console.log(errorJson);
        if(errorJson){
          toastr.error(errorJson);
        }
        current_element.removeAttr("disabled");
      } 
    });
  }else{
    //hideStage(2);showStage(3);
    current_element.removeAttr("disabled");
  }
});

$("#preview_institute").on("click", function(){
  $("#prev-org_logo").attr("src", "");
  $("#prev-org_name").text("");
  $("#prev-ins_name").text("");
  $("#prev-ins_website").text("");
  $("#prev-org_code").text("");
  $("#prev-ins_address_line_1").text("");
  $("#prev-ins_address_line_2").text("");
  $("#prev-ins_city_state_zip").text("");
  $("#prev-ins_email_id").text("");
  $("#prev-ins_phone_no").text("");
  $("#prev-user_profile_image").attr("src", "");
  $("#prev-user_name_qualification").text("");
  $("#prev-user_address_line_1").text("");
  $("#prev-user_address_line_2").text("");
  $("#prev-user_city_state_zip").text("");
  $("#prev-user_description").text("");
  $("#prev-user_email_id").text("");
  if(clg_id){
    $.ajax({
      url: API_BASE_URL + 'institute/details/'+clg_id+'/',
      type: "GET",
      headers: {
        "Authorization": "Bearer " + getUserInfo().access_token,
        "Content-Type": "application/json"
      },
      success:function(response){
        console.log(response)
        if(response){
          //prev-stream_list
            var ins_city_state_zip = response.city ? response.city: "";
            if(ins_city_state_zip){
              ins_city_state_zip+= ", "+response.state ? response.state : "";
            }else{
              ins_city_state_zip+= response.state ? response.state : "";
            }
            if(ins_city_state_zip){
              ins_city_state_zip+= " "+response.zip_code ? response.zip_code : "";
            }else{
              ins_city_state_zip+= response.zip_code ? response.zip_code : "";
            }
            var mobile_number = "";
            if(response.phone_number){
              mobile_number = (response.region_code ? response.region_code+" " : "")+ response.phone_number;
            }else{
              $(".ins_phone_prev").addClass("d-none");
            }
            if(!response.email_id){
              $(".ins_email_prev").addClass("d-none");
            }
            $("#prev-org_logo").attr("src", response.logo ? response.logo : "");
            $("#prev-org_name").text(response.organization_name ? response.organization_name : "");
            $("#prev-ins_name").text(response.name ? response.name : "");
            $("#prev-ins_website").text(response.website ? response.website : "");
            $("#prev-org_code").text(response.organization_code ? response.organization_code : "");
            $("#prev-ins_address_line_1").text(response.address_line_1 ? response.address_line_1 : "");
            $("#prev-ins_address_line_2").text(response.address_line_2 ? response.address_line_2 : "");
            $("#prev-ins_city_state_zip").text(ins_city_state_zip);
            $("#prev-ins_email_id").text(response.email_id ? response.email_id : "");
            $("#prev-ins_phone_no").text(mobile_number);
            if(response.member_details.length > 0){
              $.each(response.member_details, function( i, val ) {
                if(i == 0){
                  var user_name_qualification = val.first_name ? val.first_name +(val.last_name ? " "+val.last_name : "") : "";
                  if(user_name_qualification){
                    user_name_qualification += val.qualification ? "[ "+val.qualification+" ]" : "";
                  }
                  var user_city_state_zip = val.city ? val.city: "";
                  if(user_city_state_zip){
                    user_city_state_zip+= ", "+val.state ? val.state : "";
                  }else{
                    user_city_state_zip+= val.state ? val.state : "";
                  }
                  if(user_city_state_zip){
                    user_city_state_zip+= " "+val.zip_code ? val.zip_code : "";
                  }else{
                    user_city_state_zip+= val.zip_code ? val.zip_code : "";
                  }var user_mobile_number = "";
                  if(val.phone_number){
                    user_mobile_number = (val.region_code ? val.region_code+" " : "")+ val.phone_number;
                  }else{
                    $(".user_phone_prev").addClass("d-none");
                  }
                  if(!val.email_id){
                    $(".user_email_prev").addClass("d-none");
                  }
                  $("#prev-user_profile_image").attr("src", val.m_image ? val.m_image : "");
                  $("#prev-user_name_qualification").text(user_name_qualification);
                  $("#prev-user_address_line_1").text(val.apartment_suit_unit ? val.apartment_suit_unit : "");
                  $("#prev-user_address_line_2").text(val.street_address ? val.street_address : "");
                  $("#prev-user_city_state_zip").text(user_city_state_zip);
                  $("#prev-user_description").text(val.description ? val.description : "");
                  $("#prev-user_email_id").text(val.email_id ? val.email_id : "");
                }
              });
            }
            $("#prev-stream_list").empty();
            $('.stream_options:checked').each(function (e) {
              var stream_option_name = $(this).attr("data-item_name").trim();
              if(stream_option_name){
                $("#prev-stream_list").append(`<li class="form-label li_item mb-3">${stream_option_name}</li>`);
              }
            });
            $("#prev-course_list").empty();
            $('.course_options:checked').each(function (e) {
              var course_option_name = $(this).attr("data-item_name").trim();
              if(course_option_name){
                $("#prev-course_list").append(`<li class="form-label li_item mb-3">${course_option_name}</li>`);
              }
            });
        }
      },
      error: function(error) {
        if (error.status === 401) {
          alert("Session Expired, Please login again.");
          logoutSession();
        }
        //toastr.error("Response Error: " + error.message);
        console.log(error);
      }
    });
  }
});
$("#prev-edit_icon").on("click", function(){
  hideStage(3);showStage(1);
})
/*** Manage Academic section Ends ***/
</script>